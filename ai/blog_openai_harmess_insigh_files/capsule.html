<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Harness Engineering: 深度实践指南</title>
    <style>
        :root {
            --bg-color: #ffffff;
            --text-main: #1a1a1a;
            --text-dim: #555555;
            --text-light: #777777;
            --border-color: #e2e2e2;
            --bg-highlight: #f8f9fa;
            --bg-code: #f3f4f6;
            --accent-blue: #007aff;
            --accent-green: #34c759;
            --accent-purple: #5856d6;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            background-color: var(--bg-color);
            color: var(--text-main);
            line-height: 1.7;
            max-width: 960px;
            margin: 0 auto;
            padding: 60px 20px;
        }

        /* Hero Section */
        .hero {
            text-align: left;
            margin-bottom: 60px;
            padding-bottom: 40px;
            border-bottom: 1px solid var(--border-color);
        }

        h1 {
            font-size: 2.8rem;
            font-weight: 800;
            letter-spacing: -0.04em;
            margin-bottom: 16px;
            line-height: 1.1;
        }

        .subtitle {
            font-size: 1.3rem;
            color: var(--text-dim);
            max-width: 700px;
        }

        .stat-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            margin-top: 30px;
        }

        .stat-box {
            background: var(--bg-highlight);
            padding: 15px 20px;
            border-radius: 8px;
            border-left: 3px solid #000;
        }

        .stat-num {
            display: block;
            font-size: 1.5rem;
            font-weight: 700;
        }

        .stat-label {
            font-size: 0.85rem;
            color: var(--text-dim);
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        /* Section Styling */
        section {
            margin-bottom: 80px;
        }

        h2 {
            font-size: 1.8rem;
            font-weight: 700;
            margin-bottom: 30px;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        h2::before {
            content: '';
            display: block;
            width: 8px;
            height: 28px;
            background: #000;
            border-radius: 2px;
        }

        h3 {
            font-size: 1.25rem;
            font-weight: 600;
            margin-top: 0;
            margin-bottom: 12px;
        }

        /* Insight vs Practice Layout */
        .framework-layout {
            display: grid;
            grid-template-columns: 35% 60%; /* Left: Insight, Right: Details */
            gap: 5%;
            margin-bottom: 40px;
            align-items: start;
        }

        .insight-col {
            position: sticky;
            top: 20px;
        }

        .insight-tag {
            display: inline-block;
            font-size: 0.75rem;
            font-weight: 700;
            color: var(--accent-purple);
            text-transform: uppercase;
            margin-bottom: 8px;
            letter-spacing: 0.05em;
        }

        .insight-text {
            font-size: 1.1rem;
            font-weight: 500;
            color: var(--text-main);
            margin-bottom: 16px;
        }

        .insight-desc {
            font-size: 0.95rem;
            color: var(--text-dim);
        }

        /* Detail Cards */
        .detail-card {
            background: #fff;
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 24px;
            margin-bottom: 20px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.02);
        }

        .detail-card h4 {
            margin: 0 0 12px 0;
            font-size: 1rem;
            font-weight: 700;
            color: var(--text-main);
            display: flex;
            justify-content: space-between;
        }

        .tag-action {
            font-size: 0.7rem;
            background: var(--bg-code);
            padding: 2px 6px;
            border-radius: 4px;
            color: var(--text-dim);
            font-weight: normal;
        }

        /* Lists within cards */
        ul.detail-list {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        ul.detail-list li {
            position: relative;
            padding-left: 20px;
            margin-bottom: 12px;
            font-size: 0.95rem;
            color: var(--text-dim);
        }

        ul.detail-list li::before {
            content: "→";
            position: absolute;
            left: 0;
            color: var(--text-main);
            font-weight: bold;
        }

        ul.detail-list li strong {
            color: var(--text-main);
            font-weight: 600;
        }

        /* Code Blocks */
        .code-block {
            background: var(--bg-code);
            padding: 16px;
            border-radius: 8px;
            font-family: "SF Mono", Menlo, Monaco, Consolas, monospace;
            font-size: 0.85rem;
            color: #333;
            overflow-x: auto;
            border: 1px solid var(--border-color);
            margin-top: 15px;
        }

        .file-tree {
            line-height: 1.4;
        }

        @media (max-width: 768px) {
            .framework-layout {
                grid-template-columns: 1fr;
                gap: 20px;
            }
            .insight-col {
                position: static;
                border-bottom: 1px solid var(--border-color);
                padding-bottom: 20px;
                margin-bottom: 20px;
            }
            .stat-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>

    <div class="hero">
        <h1>Harness Engineering</h1>
        <p class="subtitle">OpenAI 工程团队如何在 5 个月内，利用 Codex 智能体以 0 行人工代码构建百万行级产品。</p>
        
        <div class="stat-grid">
            <div class="stat-box">
                <span class="stat-num">0 行</span>
                <span class="stat-label">人工编写代码</span>
            </div>
            <div class="stat-box">
                <span class="stat-num">1/10</span>
                <span class="stat-label">所需时间成本</span>
            </div>
            <div class="stat-box">
                <span class="stat-num">3.5 PRs</span>
                <span class="stat-label">人均日吞吐量</span>
            </div>
        </div>
    </div>

    <!-- Section 1 -->
    <section>
        <h2>01. 工程师角色的根本性重构</h2>
        <div class="framework-layout">
            <div class="insight-col">
                <span class="insight-tag">核心洞察</span>
                <div class="insight-text">如果不写代码，工程师在做什么？</div>
                <p class="insight-desc">
                    当执行不再是瓶颈，主要工作变成了构建能让智能体工作的“脚手架”。工程师的角色从“建筑工人”转变为“工地监理”和“模具设计师”。
                </p>
            </div>
            <div class="right-col">
                <div class="detail-card">
                    <h4>深度优先的工作模式 <span class="tag-action">Mindset</span></h4>
                    <p style="font-size: 0.95rem; color: var(--text-dim); margin-bottom: 12px;">
                        遇到问题（例如 Agent 无法修复 Bug）时，解决方案永远不是“人去写代码”，而是：
                    </p>
                    <ul class="detail-list">
                        <li><strong>识别缺失的能力：</strong> Agent 是因为看不到日志？还是不懂 UI 结构？</li>
                        <li><strong>构建工具：</strong> 为 Agent 编写工具（如 Screenshot tool）或文档。</li>
                        <li><strong>注入上下文：</strong> 将修复后的逻辑作为新能力赋予 Agent。</li>
                    </ul>
                </div>

                <div class="detail-card">
                    <h4>Ralph Wiggum Loop (反馈闭环) <span class="tag-action">Workflow</span></h4>
                    <p style="font-size: 0.95rem; color: var(--text-dim);">
                        人类仅通过 Prompt 与系统交互。所有的执行细节都封装在 Agent 的自我修正循环中：
                    </p>
                    <div class="code-block">
                        1. Agent 生成代码<br>
                        2. Agent 本地自我 Review<br>
                        3. Agent 请求云端/其他 Agent Review<br>
                        4. Agent 根据反馈（Linter报错/Review意见）修改<br>
                        5. 循环直到通过 -> 合并
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Section 2 -->
    <section>
        <h2>02. 极致的可观测性 (Agent Legibility)</h2>
        <div class="framework-layout">
            <div class="insight-col">
                <span class="insight-tag">核心洞察</span>
                <div class="insight-text">如果它“看”不到，它就修不好</div>
                <p class="insight-desc">
                    人类可以通过直觉和碎片化信息调试，但智能体只能基于明确的数字信号工作。必须将应用的运行时状态完全暴露给智能体。
                </p>
            </div>
            <div class="right-col">
                <div class="detail-card">
                    <h4>视觉与交互感知 <span class="tag-action">Tools</span></h4>
                    <ul class="detail-list">
                        <li><strong>每个 Worktree 独立启动：</strong> Codex 针对每个任务启动一个独立的 App 实例。</li>
                        <li><strong>集成 Chrome DevTools Protocol：</strong> 赋予 Agent 截图、抓取 DOM 快照、监听网络请求的能力。</li>
                        <li><strong>能力解锁：</strong> 这使得 Agent 可以不仅“写代码”，还能“重现 Bug”和“验证 UI 修复”。</li>
                    </ul>
                </div>

                <div class="detail-card">
                    <h4>临时可观测性栈 <span class="tag-action">Infrastructure</span></h4>
                    <ul class="detail-list">
                        <li><strong>Ephemeral Stack：</strong> 为每个开发任务部署临时的日志和指标栈（LogQL/PromQL）。</li>
                        <li><strong>可量化的 Prompt：</strong> 工程师可以发出极度具体的指令，如 <em>“确保服务启动时间在 800ms 以内”</em> 或 <em>“检查关键路径中没有 Span 超过 2 秒”</em>。Agent 可以通过查询指标来验证这一目标是否达成。</li>
                    </ul>
                </div>
            </div>
        </div>
    </section>

    <!-- Section 3 -->
    <section>
        <h2>03. 知识管理：给地图，别给说明书</h2>
        <div class="framework-layout">
            <div class="insight-col">
                <span class="insight-tag">核心洞察</span>
                <div class="insight-text">上下文是稀缺资源</div>
                <p class="insight-desc">
                    一个巨大的 `AGENTS.md` 是灾难性的。它会腐烂、产生幻觉，并挤占处理任务所需的上下文窗口。
                </p>
            </div>
            <div class="right-col">
                <div class="detail-card">
                    <h4>渐进式披露架构 <span class="tag-action">Architecture</span></h4>
                    <div class="code-block file-tree">
                        docs/<br>
                        ├── design-docs/ (核心信念、设计决策)<br>
                        ├── product-specs/ (产品规格)<br>
                        ├── exec-plans/ (执行计划、决策日志)<br>
                        ├── generated/ (DB Schema 等)<br>
                        AGENTS.md (仅100行，作为目录索引)
                    </div>
                    <ul class="detail-list" style="margin-top: 15px;">
                        <li><strong>目录索引法：</strong> `AGENTS.md` 仅包含指向 `docs/` 中具体文件的指针。</li>
                        <li><strong>按需加载：</strong> Agent 先读取目录，再根据任务读取特定的设计文档或计划，而非一次性吞下所有信息。</li>
                    </ul>
                </div>

                <div class="detail-card">
                    <h4>单一事实来源 (SSOT) <span class="tag-action">Protocol</span></h4>
                    <ul class="detail-list">
                        <li><strong>禁止隐性知识：</strong> 任何 Slack 讨论、口头约定若未转化为 Repo 中的 Markdown 文档，对 Agent 来说就是不存在的。</li>
                        <li><strong>计划即代码：</strong> 复杂的任务被分解为 `exec-plans` 存入代码库。Agent 可以读取当前进度，知道已完成了什么，以此实现长时任务的中断恢复。</li>
                    </ul>
                </div>
            </div>
        </div>
    </section>

    <!-- Section 4 -->
    <section>
        <h2>04. 机械化强制执行：将品味转化为代码</h2>
        <div class="framework-layout">
            <div class="insight-col">
                <span class="insight-tag">核心洞察</span>
                <div class="insight-text">对抗熵增与架构腐化</div>
                <p class="insight-desc">
                    智能体会模仿代码库中现存的“坏味道”。必须通过强硬的代码手段（而非软性的语言指令）来维持架构边界。
                </p>
            </div>
            <div class="right-col">
                <div class="detail-card">
                    <h4>自定义 Linter 作为教材 <span class="tag-action">Tooling</span></h4>
                    <p style="font-size: 0.95rem; color: var(--text-dim); margin-bottom: 12px;">
                        普通的 Linter 只报错，Agent 的 Linter 需要教学。
                    </p>
                    <ul class="detail-list">
                        <li><strong>教学式报错：</strong> 编写自定义 Linter，当检测到违规（如错误的命名、过大的文件）时，报错信息必须包含<strong>具体的修复指令和正确示例</strong>，直接注入 Agent 上下文。</li>
                        <li><strong>强制分层：</strong> 编写结构化测试，禁止跨层依赖（例如：UI 层禁止直接调用数据库层），确保架构不被“抄近道”的 Agent 破坏。</li>
                    </ul>
                </div>

                <div class="detail-card">
                    <h4>黄金原则 (Golden Principles) <span class="tag-action">Standards</span></h4>
                    <ul class="detail-list">
                        <li><strong>边界严查：</strong> 强制要求所有数据输入必须经过 Schema 验证（如 Zod）。禁止 Agent 写出“猜测数据结构”的代码。</li>
                        <li><strong>偏好无聊技术：</strong> 选择那些训练数据多、API 稳定的“无聊”库，Agent 更容易掌握。</li>
                    </ul>
                </div>
            </div>
        </div>
    </section>

    <!-- Section 5 -->
    <section>
        <h2>05. 维护与吞吐量：新常态</h2>
        <div class="framework-layout">
            <div class="insight-col">
                <span class="insight-tag">核心洞察</span>
                <div class="insight-text">修复成本 < 等待成本</div>
                <p class="insight-desc">
                    在 Agent 资源充足的环境下，传统的“谨慎合并、害怕回滚”的开发哲学已经过时。
                </p>
            </div>
            <div class="right-col">
                <div class="detail-card">
                    <h4>自动垃圾回收 (Garbage Collection) <span class="tag-action">Automation</span></h4>
                    <ul class="detail-list">
                        <li><strong>Doc-Gardening Agent：</strong> 专门的后台 Agent，定期扫描代码与文档的差异，自动提交 PR 修复过时文档。</li>
                        <li><strong>Refactor Agent：</strong> 自动扫描不符合“黄金原则”的代码（AI Slop），发起微重构 PR。</li>
                        <li><strong>策略：</strong> 每天进行小规模的清理，而不是每周五进行一次大规模的人工“铲屎”。</li>
                    </ul>
                </div>

                <div class="detail-card">
                    <h4>极速合并策略 <span class="tag-action">Process</span></h4>
                    <ul class="detail-list">
                        <li><strong>极简门槛：</strong> 减少人工 Review 的阻塞。</li>
                        <li><strong>快速试错：</strong> 遇到测试 Flake（不稳定），与其阻塞流水线等待人工排查，不如让 Agent 立即发起一个新的 PR 尝试修复。</li>
                    </ul>
                </div>
            </div>
        </div>
    </section>

</body>
</html>