<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Spec Engineering：软件工程的新核心</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>
    
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        brand: '#0f172a',
                        accent: '#3b82f6',
                        warning: '#f59e0b',
                        success: '#10b981'
                    }
                }
            }
        }
    </script>
    <style>
        .mermaid { display: flex; justify-content: center; margin: 1.5rem 0; }
        .glass-panel { background: rgba(255, 255, 255, 0.95); backdrop-filter: blur(4px); }
        [x-cloak] { display: none !important; }
        
        /* 自定义打字机光标效果 */
        .typing-cursor::after {
            content: '|';
            animation: blink 1s step-start infinite;
        }
        @keyframes blink { 50% { opacity: 0; } }
    </style>
</head>
<body class="bg-slate-100 text-slate-800 font-sans h-screen flex flex-col overflow-hidden" x-data="appData()">

    <!-- 顶部导航 -->
    <header class="bg-brand text-white shadow-lg shrink-0 z-50">
        <div class="container mx-auto px-6 py-4 flex justify-between items-center">
            <h1 class="text-xl font-bold flex items-center gap-2 tracking-wide">
                <span class="text-accent">OpenSpec</span> 深度解析报告
            </h1>
            <nav class="flex gap-1 bg-slate-800/50 p-1 rounded-lg">
                <button @click="switchTab('dashboard')" :class="tabClass('dashboard')" class="px-4 py-2 rounded-md text-sm transition-all duration-300">总览</button>
                <button @click="switchTab('chat')" :class="tabClass('chat')" class="px-4 py-2 rounded-md text-sm transition-all duration-300">团队研讨</button>
                <button @click="switchTab('knowledge')" :class="tabClass('knowledge')" class="px-4 py-2 rounded-md text-sm transition-all duration-300">OpenSpec 体系</button>
                <button @click="switchTab('insight')" :class="tabClass('insight')" class="px-4 py-2 rounded-md text-sm font-bold flex items-center gap-2 transition-all duration-300 ring-2 ring-accent ring-opacity-50">
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path></svg>
                    深度洞察
                </button>
            </nav>
        </div>
    </header>

    <!-- 主滚动区域 -->
    <main class="flex-1 overflow-y-auto relative scroll-smooth">
        <div class="container mx-auto p-6 min-h-full pb-20">

            <!-- TAB 1: 仪表盘 (保持原样，简化展示) -->
            <div x-show="currentTab === 'dashboard'" x-transition.opacity class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div class="bg-white p-6 rounded-xl shadow-sm border-t-4 border-blue-500">
                    <h2 class="text-xl font-bold mb-4">当前软件工程的痛点</h2>
                    <ul class="space-y-3 text-slate-600">
                        <li class="flex items-start gap-2">
                            <span class="text-red-500 mt-1">✕</span>
                            <span><strong>模糊性 (Ambiguity)：</strong> 人类习惯脑补需求，但 AI 只能基于概率预测。Spec 不准，AI 必错。</span>
                        </li>
                        <li class="flex items-start gap-2">
                            <span class="text-red-500 mt-1">✕</span>
                            <span><strong>上下文丢失：</strong> 需求在 PM -> 架构师 -> 开发者 -> 代码 的传递中逐层失真。</span>
                        </li>
                        <li class="flex items-start gap-2">
                            <span class="text-red-500 mt-1">✕</span>
                            <span><strong>维护成本：</strong> 代码改了，文档没改。下次 AI 读取文档时，得到的是过时信息。</span>
                        </li>
                    </ul>
                </div>
                <div class="bg-white p-6 rounded-xl shadow-sm border-t-4 border-green-500">
                    <h2 class="text-xl font-bold mb-4">Spec Engineering 的价值</h2>
                    <div class="mermaid">
                        graph LR
                        A[模糊意图] -->|Spec工程化| B(结构化契约)
                        B -->|驱动| C[Human Dev]
                        B -->|驱动| D[AI Agent]
                        C --> E[高质量软件]
                        D --> E
                        B -->|自动生成| F[测试用例]
                    </div>
                </div>
            </div>

            <!-- TAB 2: 团队研讨 (简化版) -->
            <div x-show="currentTab === 'chat'" class="max-w-4xl mx-auto">
                <div class="space-y-4">
                     <!-- 仅展示核心引言 -->
                     <div class="bg-indigo-50 p-4 rounded-lg border-l-4 border-indigo-500">
                        <div class="font-bold text-indigo-900 mb-1">Spy (关键洞察)</div>
                        <p class="text-indigo-800">"如果是架构的关键文档，你就建一个 Agents/ 目录... 这样渐进式加载，会节省不少 token。"</p>
                        <div class="mt-2 text-xs text-indigo-600 font-mono">>> 解析：Spec 是 AI 的外挂显存，管理 Spec 就是管理 AI 的认知边界。</div>
                    </div>
                    <div class="bg-emerald-50 p-4 rounded-lg border-l-4 border-emerald-500">
                        <div class="font-bold text-emerald-900 mb-1">Jun (关键洞察)</div>
                        <p class="text-emerald-800">"结构化拆解管理spec从头到尾的过程，pm实际上参与很少... 大坑也在这。"</p>
                        <div class="mt-2 text-xs text-emerald-600 font-mono">>> 解析：Spec 能力的缺失是产品与工程脱节的根本原因。</div>
                    </div>
                </div>
            </div>

            <!-- TAB 3: 知识体系 (OpenSpec) -->
            <div x-show="currentTab === 'knowledge'" class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                <div class="lg:col-span-1 bg-white p-5 rounded shadow">
                    <h3 class="font-bold mb-3 border-b pb-2">Artifact 层次</h3>
                    <ul class="text-sm space-y-4">
                        <li>
                            <div class="font-bold text-blue-600">1. Proposal (Why)</div>
                            <div class="text-slate-500 text-xs">战略意图，不可逆决策</div>
                        </li>
                        <li>
                            <div class="font-bold text-green-600">2. Specs (What)</div>
                            <div class="text-slate-500 text-xs">系统行为，验收标准 (SHALL/MUST)</div>
                        </li>
                        <li>
                            <div class="font-bold text-amber-600">3. Design (How)</div>
                            <div class="text-slate-500 text-xs">技术实现，架构权衡</div>
                        </li>
                    </ul>
                </div>
                <div class="lg:col-span-2 bg-white p-5 rounded shadow">
                    <h3 class="font-bold mb-3">Spec 示例：AI 可读性对比</h3>
                    <div class="grid grid-cols-2 gap-4">
                        <div class="bg-red-50 p-3 rounded">
                            <div class="text-red-800 font-bold text-xs mb-1">❌ 传统文档 (给人类看)</div>
                            <p class="text-xs text-slate-600">"用户登录后应该能看到仪表盘，如果没权限就提示一下。"</p>
                            <div class="mt-2 text-red-500 text-[10px]">AI 困惑：具体的 URL 是什么？没权限返回 401 还是 403？提示是 Toast 还是 Alert？</div>
                        </div>
                        <div class="bg-green-50 p-3 rounded">
                            <div class="text-green-800 font-bold text-xs mb-1">✅ OpenSpec (给 Agent 看)</div>
                            <pre class="text-[10px] text-slate-700 whitespace-pre-wrap">
Scenario: 用户登录重定向
- WHEN: User logs in successfully
- THEN: System SHALL redirect to `/dashboard`

Scenario: 权限不足处理
- WHEN: User lacks `view_dashboard` permission
- THEN: System SHALL return HTTP 403
- AND: System SHALL display error toast "Access Denied"</pre>
                        </div>
                    </div>
                </div>
            </div>

            <!-- TAB 4: 深度洞察 (全新模块) -->
            <div x-show="currentTab === 'insight'" x-transition class="space-y-8 pb-12">
                
                <!-- 1. 核心论点 Banner -->
                <div class="bg-gradient-to-r from-slate-900 to-slate-800 text-white p-8 rounded-2xl shadow-2xl relative overflow-hidden">
                    <div class="relative z-10 max-w-3xl">
                        <h2 class="text-3xl font-extrabold mb-4">Spec Engineering: 智能时代的“元编程”</h2>
                        <p class="text-lg text-slate-300 leading-relaxed">
                            在 AI 辅助编程时代，我们不再直接编写循环和判断，我们编写<span class="text-accent font-bold">约束 (Constraints)</span> 和 <span class="text-accent font-bold">意图 (Intents)</span>。
                            <br>Spec 的质量，直接决定了 AI 生成代码的上限。
                        </p>
                    </div>
                    <div class="absolute right-0 top-0 opacity-10">
                        <svg class="w-64 h-64" fill="currentColor" viewBox="0 0 24 24"><path d="M14 2H6c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8l-6-6zm2 16H8v-2h8v2zm0-4H8v-2h8v2zm-3-5V3.5L18.5 9H13z"/></svg>
                    </div>
                </div>

                <!-- 2. Spec 的双重作用模型 -->
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                    <!-- 左侧：认知桥梁 -->
                    <div class="bg-white p-6 rounded-xl shadow-lg border border-slate-100">
                        <h3 class="text-xl font-bold text-slate-800 mb-4 flex items-center gap-2">
                            <span class="bg-blue-100 text-blue-600 py-1 px-3 rounded text-sm">作用一</span>
                            消除歧义的“分界线”
                        </h3>
                        <p class="text-slate-600 mb-4 text-sm">
                            Spec 是划分<strong>“业务期望”</strong>与<strong>“工程实现”</strong>的刚性界面。如果没有这一层，业务的模糊性会直接污染代码库。
                        </p>
                        <div class="mermaid">
                            graph TD
                            Business[业务: 模糊、多变] -->|Spec Engineering| Spec[Spec: 精确、逻辑闭环]
                            Spec -->|Prompt| AI[AI Agent]
                            Spec -->|Constraint| Human[工程师]
                            AI --> Code[代码实现]
                            Human --> Code
                            style Spec fill:#dbeafe,stroke:#2563eb,stroke-width:2px
                        </div>
                    </div>

                    <!-- 右侧：V模型重构 -->
                    <div class="bg-white p-6 rounded-xl shadow-lg border border-slate-100">
                        <h3 class="text-xl font-bold text-slate-800 mb-4 flex items-center gap-2">
                            <span class="bg-green-100 text-green-600 py-1 px-3 rounded text-sm">作用二</span>
                            V-Model 的测试基准
                        </h3>
                        <p class="text-slate-600 mb-4 text-sm">
                            Spec 不仅仅是生成代码的依据，更是<strong>生成测试用例</strong>的依据。AI 可以根据 Spec 同时写出 Code 和 Test，实现自我验证。
                        </p>
                        <div class="mermaid">
                            graph TD
                            Spec[Spec 文档]
                            Spec -->|生成| Code[业务代码]
                            Spec -->|生成| Test[测试代码]
                            Code -->|运行| Runner{CI/CD}
                            Test -->|验证| Runner
                            Runner -->|通过| Pass[✅ 交付]
                            Runner -->|失败| Fail[❌ 修正Spec或代码]
                            style Spec fill:#d1fae5,stroke:#059669,stroke-width:2px
                        </div>
                    </div>
                </div>

                <!-- 3. 为什么 Spec 管理如此重要 -->
                <div class="bg-white rounded-xl shadow-lg border border-slate-100 overflow-hidden">
                    <div class="p-6 border-b border-slate-100 bg-slate-50">
                        <h3 class="text-xl font-bold text-slate-800">为什么“写好、管好 Spec”是核心能力？</h3>
                    </div>
                    <div class="grid grid-cols-1 md:grid-cols-3 divide-y md:divide-y-0 md:divide-x divide-slate-100">
                        
                        <!-- 维度 1 -->
                        <div class="p-6 hover:bg-slate-50 transition">
                            <div class="text-4xl mb-4">🧠</div>
                            <h4 class="font-bold text-lg mb-2">对抗认知负荷</h4>
                            <p class="text-sm text-slate-600 leading-relaxed">
                                现代软件太复杂，没人能记住所有细节。Spec 是<strong>外挂大脑</strong>。
                                <br><br>
                                <span class="bg-yellow-100 text-yellow-800 px-2 py-0.5 rounded text-xs">AI场景</span> AI 的 Context Window 是有限的。良好的 Spec 拆分（如 OpenSpec 的分层结构）允许 AI 按需加载上下文，避免“遗忘”或“幻觉”。
                            </p>
                        </div>

                        <!-- 维度 2 -->
                        <div class="p-6 hover:bg-slate-50 transition">
                            <div class="text-4xl mb-4">⚖️</div>
                            <h4 class="font-bold text-lg mb-2">单一真理来源 (SSOT)</h4>
                            <p class="text-sm text-slate-600 leading-relaxed">
                                代码会变，口头沟通会忘。只有 Spec 应该是<strong>法律条文</strong>。
                                <br><br>
                                <span class="bg-yellow-100 text-yellow-800 px-2 py-0.5 rounded text-xs">AI场景</span> 当 AI 修改了代码但没改文档时，系统就腐烂了。必须强制 AI 遵循 <code class="bg-slate-200 px-1 rounded">Spec First</code> 流程：先改 Spec，再改代码。
                            </p>
                        </div>

                        <!-- 维度 3 -->
                        <div class="p-6 hover:bg-slate-50 transition">
                            <div class="text-4xl mb-4">💬</div>
                            <h4 class="font-bold text-lg mb-2">低成本试错</h4>
                            <p class="text-sm text-slate-600 leading-relaxed">
                                修改 Spec 的成本是修改代码的 1/10，是修复线上 Bug 的 1/100。
                                <br><br>
                                <span class="bg-yellow-100 text-yellow-800 px-2 py-0.5 rounded text-xs">AI场景</span> 让 AI 先输出 Proposal/Design 进行审查，这本质上是<strong>在自然语言层面进行 Debug</strong>，成本极低。
                            </p>
                        </div>
                    </div>
                </div>

                <!-- 4. 实战建议 -->
                <div class="bg-brand text-slate-300 rounded-xl p-8 shadow-lg">
                    <h3 class="text-white text-2xl font-bold mb-6">致团队：如何提升 Spec 能力？</h3>
                    <div class="space-y-6">
                        <div class="flex gap-4">
                            <div class="text-accent font-bold text-xl">01</div>
                            <div>
                                <h4 class="text-white font-bold text-lg">产品经理要懂“结构化表达”</h4>
                                <p class="mt-1">告别文学性的“用户故事”，转向逻辑性的“行为契约”。学习 <code class="text-accent">Gherkin</code> (Given/When/Then) 语法，这是人机共通的语言。</p>
                            </div>
                        </div>
                        <div class="flex gap-4">
                            <div class="text-accent font-bold text-xl">02</div>
                            <div>
                                <h4 class="text-white font-bold text-lg">工程师要成为“Spec 审查员”</h4>
                                <p class="mt-1">以前 Review 代码，现在 Review Spec。如果 Spec 没写清楚边界条件（如：空值怎么处理？并发怎么处理？），坚决不让 AI 开始写代码。</p>
                            </div>
                        </div>
                        <div class="flex gap-4">
                            <div class="text-accent font-bold text-xl">03</div>
                            <div>
                                <h4 class="text-white font-bold text-lg">建立 Spec 的 CI/CD</h4>
                                <p class="mt-1">Spec 文档也应该纳入版本控制（Git）。每一次 Spec 的变更都应触发 Review。不要让文档游离于工程之外。</p>
                            </div>
                        </div>
                    </div>
                </div>

            </div>
        </div>
    </main>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            mermaid.initialize({ startOnLoad: true, theme: 'neutral', securityLevel: 'loose' });
        });

        function appData() {
            return {
                currentTab: 'insight', // 默认打开深度洞察 tab
                
                tabClass(tabName) {
                    if (this.currentTab === tabName) {
                        return 'bg-brand text-white shadow-md transform scale-105';
                    }
                    return 'text-slate-300 hover:bg-slate-700 hover:text-white';
                },

                switchTab(tabName) {
                    this.currentTab = tabName;
                    // 给 mermaid 一点时间重新渲染（如果需要）
                    setTimeout(() => {
                        window.scrollTo({ top: 0, behavior: 'smooth' });
                    }, 10);
                }
            }
        }
    </script>
</body>
</html>